<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Apparel Machinery | Industrial Sewing & Garment Equipment</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
    <!-- Firebase App & Firestore -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <style>
        body {background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%); min-height: 100vh; padding: 20px; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;}
        .container {max-width: 1200px; margin:0 auto; background:#fff; border-radius:15px; box-shadow:0 5px 15px rgba(0,0,0,0.08); overflow:hidden; border:1px solid #e2e8f0;}
        .top-bar {display: flex; justify-content: space-between; align-items: center; padding: 15px 20px; background: #2563eb; color: #f8fafc;}
        .top-buttons { display: flex; gap: 10px;}
        .top-btn { display: flex; align-items: center; gap: 5px; padding: 8px 15px; background: #3b82f6; color: white; border: none; border-radius: 5px; cursor: pointer; transition: background 0.3s;}
        .top-btn:hover { background: #1e40af;}
        .google-translate {display: flex; align-items: center;}
        .banner-section {position: relative; height: 300px; overflow: hidden;}
        .banner-image {width: 100%; height: 100%; object-fit: cover;}
        .banner-overlay {position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; flex-direction: column; justify-content: center; align-items: center; background: rgba(0,0,0,0.5); color: white;}
        .banner-overlay h1 {font-size: 36px; margin-bottom: 10px; text-shadow: 2px 2px 4px rgba(0,0,0,0.7);}
        .banner-overlay p {font-size: 18px; text-shadow: 1px 1px 2px rgba(0,0,0,0.7);}
        .banner-cart-btn {position: absolute; top: 20px; right: 20px; display: flex; align-items: center; gap: 5px; padding: 10px 15px; background: #3b82f6; color: white; border: none; border-radius: 5px; cursor: pointer; z-index: 10;}
        .cart-count {background: #ef4444; color: white; border-radius: 50%; width: 20px; height: 20px; display: flex; justify-content: center; align-items: center; font-size: 12px;}
        .banner-upload {position: absolute; bottom: 20px; right: 20px; display: flex; align-items: center; gap: 5px; padding: 8px 15px; background: #3b82f6; color: white; border: none; border-radius: 5px; cursor: pointer; z-index: 10;}
        .banner-upload input {display: none;}
        .cart-container {position: absolute; top: 70px; right: 20px; width: 300px; background: #fff; border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); z-index: 20; display: none;}
        .cart-header {display: flex; justify-content: space-between; align-items: center; padding: 15px; border-bottom: 1px solid #e2e8f0;}
        .cart-close {background: none; border: none; font-size: 20px; cursor: pointer; color: #000;}
        .cart-items {padding: 15px; max-height: 300px; overflow-y: auto;}
        .cart-empty {text-align: center; color: #000; padding: 20px;}
        .cart-item {display: flex; justify-content: space-between; align-items: center; padding: 10px 0; border-bottom: 1px solid #e2e8f0;}
        .cart-actions {padding: 15px; border-top: 1px solid #e2e8f0;}
        .confirm-order-btn {width: 100%; padding: 12px; background: #10b981; color: white; border: none; border-radius: 5px; cursor: pointer; display: flex; justify-content: center; align-items: center; gap: 5px;}
        .main-content {padding: 20px;}
        .section-title {font-size: 24px; margin-bottom: 20px; color: #2563eb; text-align: center;}
        .gallery-section {display: none; margin-bottom: 30px;}
        .gallery-container {display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px;}
        .gallery-item {height: 200px; overflow: hidden; border-radius: 10px; box-shadow: 0 3px 10px rgba(0,0,0,0.1);}
        .gallery-item img {width: 100%; height: 100%; object-fit: cover;}
        .admin-panel {display: none; margin-bottom: 30px; padding: 20px; background: #dbeafe; border-radius: 10px;}
        .admin-tabs {display: flex; margin-bottom: 20px; border-bottom: 2px solid #dbeafe;}
        .admin-tab-btn {padding: 10px 20px; background: none; border: none; cursor: pointer; font-weight: bold;}
        .admin-tab-btn.active {border-bottom: 3px solid #2563eb;}
        .admin-tab-content {display: none;}
        .admin-section {margin-bottom: 30px; padding: 20px; background: #fff; border-radius: 10px; box-shadow: 0 3px 10px rgba(0,0,0,0.05);}
        .admin-section h3 {margin-bottom: 15px; color: #2563eb;}
        .form-container {max-width: 600px;}
        .form-group {margin-bottom: 15px;}
        .form-group label {display: block; margin-bottom: 5px; font-weight: bold;}
        .form-group input, .form-group select, .form-group textarea {width: 100%; padding: 10px; border: 1px solid #e2e8f0; border-radius: 5px;}
        .image-preview, .video-preview {margin-top: 10px; display: none;}
        .image-preview img, .video-preview video {max-width: 100%; max-height: 200px; border-radius: 5px;}
        .remove-media {margin-top: 5px; padding: 5px 10px; background: #ef4444; color: white; border: none; border-radius: 3px; cursor: pointer;}
        .form-submit {padding: 12px 20px; background: #2563eb; color: white; border: none; border-radius: 5px; cursor: pointer; display: flex; align-items: center; gap: 5px;}
        .admin-product-list {display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px;}
        .admin-product-card {padding: 15px; background: #fff; border-radius: 10px; box-shadow: 0 3px 10px rgba(0,0,0,0.1);}
        .admin-product-card h4 {margin-bottom: 10px; color: #2563eb;}
        .admin-product-actions {display: flex; gap: 10px; margin-top: 15px;}
        .admin-product-btn {padding: 8px 12px; border: none; border-radius: 5px; cursor: pointer; display: flex; align-items: center; gap: 5px;}
        .btn-edit {background: #f59e0b; color: white;}
        .btn-delete {background: #ef4444; color: white;}
        .orders-container {overflow-x: auto;}
        .orders-table {width: 100%; border-collapse: collapse;}
        .orders-table th, .orders-table td {padding: 12px; text-align: left; border-bottom: 1px solid #e2e8f0;}
        .orders-table th {background: #dbeafe; font-weight: bold;}
        .order-status {padding: 5px 10px; border-radius: 20px; font-size: 12px; font-weight: bold;}
        .status-pending {background: #fef3c7; color: #92400e;}
        .status-confirmed {background: #d1fae5; color: #065f46;}
        .status-completed {background: #dcfce7; color: #166534;}
        .status-cancelled {background: #fee2e2; color: #991b1b;}
        .view-order-btn {padding: 6px 12px; background: #3b82f6; color: white; border: none; border-radius: 3px; cursor: pointer; display: flex; align-items: center; gap: 5px;}
        .close-btn {padding: 10px 15px; background: #ef4444; color: white; border: none; border-radius: 5px; cursor: pointer; display: flex; align-items: center; gap: 5px;}
        .categories-section {margin-bottom: 30px;}
        .categories-container {display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; margin-bottom: 20px;}
        .category-btn {padding: 10px 20px; background: #dbeafe; color: #2563eb; border: none; border-radius: 5px; cursor: pointer; transition: all 0.3s;}
        .category-btn.active, .category-btn:hover {background: #2563eb; color: white;}
        .search-section {margin-bottom: 30px;}
        .search-header {display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;}
        .search-bar {display: flex; gap: 10px;}
        .search-input {padding: 10px; border: 1px solid #e2e8f0; border-radius: 5px; min-width: 300px;}
        .search-btn {padding: 10px 15px; background: #2563eb; color: white; border: none; border-radius: 5px; cursor: pointer; display: flex; align-items: center; gap: 5px;}
        .products-section {margin-bottom: 30px;}
        .products-grid {display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px;}
        .product-card {background: #fff; border-radius: 10px; overflow: hidden; box-shadow: 0 3px 10px rgba(0,0,0,0.1); transition: transform 0.3s;}
        .product-card:hover {transform: translateY(-5px);}
        .product-image {height: 200px; display: flex; justify-content: center; align-items: center; background: #f8fafc; overflow: hidden;}
        .product-image img {width: 100%; height: 100%; object-fit: cover;}
        .product-image i {font-size: 60px; color: #cbd5e1;}
        .product-details {padding: 15px;}
        .product-title {font-size: 18px; margin-bottom: 10px; color: #2563eb;}
        .product-code, .product-manufacturer {font-size: 14px; color: #64748b; margin-bottom: 5px;}
        .product-description {font-size: 14px; color: #334155; margin-bottom: 10px;}
        .product-condition {display: inline-block; padding: 3px 8px; border-radius: 20px; font-size: 12px; font-weight: bold; margin-bottom: 15px;}
        .condition-new {background: #d1fae5; color: #065f46;}
        .condition-used {background: #fef3c7; color: #92400e;}
        .add-to-cart-btn {width: 100%; padding: 10px; background: #2563eb; color: white; border: none; border-radius: 5px; cursor: pointer; display: flex; justify-content: center; align-items: center; gap: 5px; transition: background 0.3s;}
        .add-to-cart-btn:hover {background: #1e40af;}
        .order-summary {display: none; margin-top: 30px; padding: 20px; background: #dbeafe; border-radius: 10px;}
        .customer-details, .selected-items {margin-bottom: 20px;}
        .customer-details h3, .selected-items h3 {margin-bottom: 15px; color: #2563eb;}
        .customer-info {display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 15px;}
        .info-item {padding: 10px; background: #fff; border-radius: 5px;}
        .info-item label {font-weight: bold; display: block; margin-bottom: 5px; color: #2563eb;}
        .selected-items-list {max-height: 300px; overflow-y: auto;}
        .selected-item {padding: 10px; background: #fff; border-radius: 5px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center;}
        .whatsapp-btn-container {display: flex; gap: 10px;}
        .whatsapp-btn {padding: 12px 20px; background: #25D366; color: white; border: none; border-radius: 5px; cursor: pointer; display: flex; align-items: center; gap: 5px;}
        footer {padding: 20px; text-align: center; background: #2563eb; color: white;}
        .modal {display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); justify-content: center; align-items: center; z-index: 1000;}
        .modal-content {background: #fff; border-radius: 10px; width: 90%; max-width: 600px; max-height: 90vh; overflow-y: auto; box-shadow: 0 5px 15px rgba(0,0,0,0.2);}
        .modal-header {display: flex; justify-content: space-between; align-items: center; padding: 15px 20px; border-bottom: 1px solid #e2e8f0;}
        .modal-header h2 {color: #2563eb;}
        .modal-close {background: none; border: none; font-size: 24px; cursor: pointer; color: #000;}
        .modal-body {padding: 20px;}
        @media (max-width: 768px) {
            .top-bar {flex-direction: column; gap: 10px;}
            .products-grid {grid-template-columns: 1fr !important;}
            .search-header {flex-direction: column; gap: 15px;}
            .search-input {min-width: auto;}
            .banner-section {height: 200px;}
            .banner-overlay h1 {font-size: 24px;}
            .banner-overlay p {font-size: 14px;}
            .category-btn {padding: 8px 12px; font-size: 14px;}
            .admin-product-list {grid-template-columns: 1fr;}
            .customer-info {grid-template-columns: 1fr;}
            .whatsapp-btn-container {flex-direction: column;}
        }
    </style>
</head>
<body>
    <!-- HTML sections and modals (as per your original code) go here -->
    <!-- ... For brevity, the modals and forms you already have are unchanged ... -->
    <script>
    // ---- Firebase config ----
    const firebaseConfig = {
      apiKey: "AIzaSyB9JR7JTfoC8zeKMFqNzOiQn4mAIrvKXSk",
      authDomain: "apparel-machinery.firebaseapp.com",
      projectId: "apparel-machinery",
      storageBucket: "apparel-machinery.appspot.com",
      messagingSenderId: "165173029685",
      appId: "1:165173029685:web:23d0bc7f2c0752adc63a7c",
      measurementId: "G-XHMZ4BP7CW"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // References
    const productsRef = db.collection("products");
    const ordersRef = db.collection("orders");
    const bannerRef = db.collection("settings").doc("banner");

    let products = [];
    let orders = [];
    let cart = JSON.parse(localStorage.getItem('apparel_cart')) || [];
    let currentCustomer = JSON.parse(localStorage.getItem('apparel_customer')) || null;
    let currentCategory = 'all';

    document.addEventListener('DOMContentLoaded', function() {
        productsRef.orderBy("displayOrder").onSnapshot(snapshot => {
            products = [];
            snapshot.forEach(doc => products.push({ id: doc.id, ...doc.data() }));
            filterProductsByCategory();
            loadAdminProducts();
            loadGallery();
        });
        ordersRef.orderBy("date", "desc").onSnapshot(snapshot => {
            orders = [];
            snapshot.forEach(doc => orders.push({ id: doc.id, ...doc.data() }));
            loadOrders();
        });
        updateCartCount();
        setupCategoryButtons();
        setupBannerUpload();
        loadBannerFromFirebase();
    });

    // ... All your JS functions (addProduct, updateProduct, deleteProduct, addToCart, updateCartCount, searchProducts, etc.) remain the same ...
    // ... Just change product card rendering functions as below ...

    function renderProductCard(product) {
        return `
        <div class="product-card">
            <div class="product-image">
                ${product.image ? `<img src="${product.image}" alt="${product.name}">` : `<i class="fas fa-tshirt"></i>`}
            </div>
            <div class="product-details">
                <h3 class="product-title">${product.name}</h3>
                <div class="product-code">Code: ${product.code}</div>
                <div class="product-manufacturer">Manufacturer: ${product.manufacturer}</div>
                <p class="product-description">${product.description}</p>
                <span class="product-condition condition-${product.condition}">${product.condition}</span>
                <button class="add-to-cart-btn" onclick="addToCart('${product.id}')"><i class="fas fa-cart-plus"></i> Add to Cart</button>
            </div>
        </div>
        `;
    }

    function renderAdminProductCard(product) {
        return `
        <div class="admin-product-card">
            <h4>${product.name}</h4>
            <div><strong>Code:</strong> ${product.code}</div>
            <div><strong>Manufacturer:</strong> ${product.manufacturer}</div>
            <div><strong>Category:</strong> ${product.category}</div>
            <div><strong>Condition:</strong> ${product.condition}</div>
            <div><strong>Price:</strong> Rs. ${product.price ? product.price.toLocaleString() : 'N/A'}</div>
            ${product.image ? `<div><img src="${product.image}" alt="${product.name}" style="max-width: 100%; height: auto; margin-top: 10px; border-radius: 5px;"></div>` : ''}
            <div class="admin-product-actions">
                <button class="admin-product-btn btn-edit" onclick="openEditModal('${product.id}')"><i class="fas fa-edit"></i> Edit</button>
                <button class="admin-product-btn btn-delete" onclick="deleteProduct('${product.id}')"><i class="fas fa-trash"></i> Delete</button>
            </div>
        </div>
        `;
    }

    // ... باقی code unchanged: category filter, cart, modals, gallery, search, orders, WhatsApp/email order, etc ...
    // ... If you want complete JS functions pasted, let me know! ...
    </script>
</body>
</html>